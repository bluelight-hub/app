= ADR-010: Entfernung der Multi-Faktor-Authentifizierung (MFA/2FA)
:author: Bluelight-Hub Team
:revnumber: 1.0.0
:revdate: 2025-06-25
:

== Status
Akzeptiert (Stand: 2025-06-25)

== Kontext
Das Bluelight-Hub-System hatte eine vollst√§ndige Multi-Faktor-Authentifizierung (MFA) implementiert, die sowohl TOTP (Time-based One-Time Password) als auch WebAuthn unterst√ºtzte. Nach der initialen Implementierung wurde die Entscheidung getroffen, die gesamte MFA-Funktionalit√§t wieder zu entfernen. Diese Entscheidung stellt einen Breaking Change dar und bedarf einer detaillierten Dokumentation.

=== Urspr√ºngliche Implementierung
Die MFA-Implementierung umfasste:
* TOTP-basierte 2FA (Google Authenticator, Authy, etc.)
* WebAuthn-Unterst√ºtzung f√ºr Hardware-Sicherheitsschl√ºssel
* Vollst√§ndige Frontend-Integration mit MFA-Komponenten
* Backend-Validierung und Session-Management
* Recovery-Codes f√ºr Account-Wiederherstellung

== Gr√ºnde f√ºr die Entfernung

=== 1. Komplexit√§t vs. Nutzen f√ºr Zielgruppe
* *Zielgruppe*: Rettungsdienste und Einsatzorganisationen arbeiten prim√§r in geschlossenen, physisch gesicherten Umgebungen
* *Einsatzszenarien*: Schneller Zugriff in Notfallsituationen hat Priorit√§t √ºber zus√§tzliche Authentifizierungsschritte
* *Nutzerfeedback*: MFA wurde als Hindernis in zeitkritischen Situationen wahrgenommen

=== 2. Operationale Herausforderungen
* *Support-Aufwand*: H√§ufige Account-Sperrungen durch verlorene 2FA-Ger√§te
* *Einsatzbereitschaft*: MFA kann im Katastrophenfall (kein Mobilfunknetz, besch√§digte Hardware) zum Zugangshindernis werden
* *Schulungsaufwand*: Zus√§tzlicher Trainingsaufwand f√ºr nicht-technisches Personal

=== 3. Alternative Sicherheitsma√ünahmen
* *Netzwerk-Isolation*: Einsatz in geschlossenen Beh√∂rdennetzen ohne Internetzugang
* *Physische Sicherheit*: Zugang nur in gesicherten Leitstellen und Fahrzeugen
* *Session-Management*: Verst√§rktes Monitoring und automatische Session-Timeouts
* *IP-Whitelisting*: Beschr√§nkung auf bekannte Netzwerke

=== 4. Technische √úberlegungen
* *Wartungsaufwand*: MFA-Systeme erfordern kontinuierliche Updates und Sicherheitspatches
* *Abh√§ngigkeiten*: Reduzierung externer Abh√§ngigkeiten (Authenticator-Apps, Hardware-Token)
* *Offline-F√§higkeit*: Verbesserte Funktionalit√§t in Offline-Szenarien

== Entscheidung
Wir haben uns f√ºr die vollst√§ndige Entfernung der MFA-Funktionalit√§t entschieden und setzen stattdessen auf kompensatorische Sicherheitsma√ünahmen, die besser auf die spezifischen Anforderungen von Einsatzorganisationen zugeschnitten sind.

== Kompensatorische Sicherheitsma√ünahmen

=== Verst√§rkte Basis-Sicherheit
* *Starke Passwort-Richtlinien*:
  ** Mindestl√§nge: 12 Zeichen
  ** Komplexit√§tsanforderungen
  ** Regelm√§√üige Passwort-Rotation (90 Tage)
  ** Passwort-Historie (keine Wiederverwendung der letzten 5 Passw√∂rter)

=== Netzwerk-basierte Sicherheit
* *IP-Whitelisting*: Zugriff nur aus definierten Netzwerkbereichen
* *VPN-Pflicht*: F√ºr externe Zugriffe
* *Geo-Blocking*: Beschr√§nkung auf definierte geografische Regionen

=== Erweitertes Session-Management
* *Adaptive Session-Timeouts*:
  ** Kurze Timeouts (15 Min) f√ºr administrative Funktionen
  ** Standard-Timeouts (4 Stunden) f√ºr operative Nutzung
  ** Verl√§ngerte Sessions nur in gesicherten Umgebungen
* *Device Fingerprinting*: Erkennung und Warnung bei neuen Ger√§ten
* *Concurrent Session Limits*: Maximale Anzahl gleichzeitiger Sessions pro Benutzer

=== Monitoring und Audit
* *Erweiterte Login-Protokollierung*:
  ** Alle Login-Versuche (erfolgreich und fehlgeschlagen)
  ** Device-Informationen und IP-Adressen
  ** Geografische Anomalie-Erkennung
* *Echtzeit-Alerts*:
  ** Mehrfache fehlgeschlagene Login-Versuche
  ** Logins von unbekannten Standorten
  ** Verd√§chtige Aktivit√§tsmuster
* *Regelm√§√üige Security-Audits*

=== Organisatorische Ma√ünahmen
* *Rollenbasierte Zugriffskontrolle (RBAC)*: Strikte Rechtevergabe nach Prinzip der minimalen Rechte
* *Regelm√§√üige Zugriffsreviews*: Quartalsweise √úberpr√ºfung der Benutzerrechte
* *Incident Response Plan*: Definierte Prozesse f√ºr Sicherheitsvorf√§lle

== Breaking Change Dokumentation

=== Betroffene Komponenten
* *Frontend*:
  ** Entfernung aller MFA-UI-Komponenten
  ** Anpassung der Benutzereinstellungen
  ** Vereinfachter Login-Flow
* *Backend*:
  ** Entfernung der MFA-Endpoints
  ** Datenbank-Migration zur Entfernung von MFA-Feldern
  ** Anpassung der Authentication-Middleware
* *API*:
  ** Breaking Change in der Authentication API
  ** Entfernung von MFA-bezogenen Endpoints

=== Migration
* *Datenbank-Migration*: Automatisches Entfernen aller MFA-Daten
* *Session-Invalidierung*: Alle bestehenden Sessions werden invalidiert
* *Kommunikation*: Rechtzeitige Information aller Nutzer √ºber die √Ñnderung

== Konsequenzen

=== Positive Konsequenzen
* *Verbesserte Einsatzbereitschaft*: Schnellerer Zugang in Notfallsituationen
* *Reduzierte Komplexit√§t*: Einfacherer Code, weniger Abh√§ngigkeiten
* *Geringerer Support-Aufwand*: Keine MFA-bedingten Zugriffsprobleme
* *Bessere Offline-F√§higkeit*: Keine Abh√§ngigkeit von externen Authentifikatoren
* *Angepasste Sicherheit*: Ma√ünahmen, die besser zur Zielgruppe passen

=== Negative Konsequenzen
* *Reduzierte Account-Sicherheit*: Anf√§lliger f√ºr kompromittierte Passw√∂rter
* *Compliance-Herausforderungen*: M√∂gliche Konflikte mit Sicherheitsrichtlinien
* *Wahrnehmung*: K√∂nnte als R√ºckschritt in der Sicherheit wahrgenommen werden
* *Breaking Change*: Erfordert Updates in allen Client-Anwendungen

=== Risiko-Mitigation
* Kontinuierliche √úberwachung der Sicherheitslage
* Regelm√§√üige Penetrationstests
* M√∂glichkeit zur schnellen Wiedereinf√ºhrung von MFA bei Bedarf
* Verst√§rkte Schulung des Personals in Sicherheitsbewusstsein

== Zuk√ºnftige √úberlegungen
Die Architektur bleibt flexibel genug, um MFA bei Bedarf wieder einzuf√ºhren. Folgende Szenarien k√∂nnten eine Neubewertung erfordern:
* √Ñnderung regulatorischer Anforderungen
* Signifikante Sicherheitsvorf√§lle
* Explizite Anforderung durch Kunden
* Verf√ºgbarkeit von einsatztauglichen MFA-L√∂sungen (z.B. biometrische Verfahren)

== Referenzen
* Commit "‚ú®(frontend): Integrate MFA components in the user interface" - Initiale MFA-Implementierung
* Commit "üí•(auth): Remove MFA/2FA functionality completely" - Entfernung der MFA-Funktionalit√§t
* ADR-007: JWT f√ºr Authentifizierung - Basis-Authentifizierungsstrategie