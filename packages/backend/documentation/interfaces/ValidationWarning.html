<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>@bluelight-hub/backend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">@bluelight-hub/backend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">













<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  ValidationWarning</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/modules/seed/schema-validator.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Validierungswarnung f√ºr nicht-kritische Probleme.</p>

            </p>


        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#code" 
>
                                            code
                                        </a>
                                </li>
                                <li>
                                        <a href="#message" 
>
                                            message
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#path" 
>
                                            path
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#recommendation" 
>
                                            recommendation
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="code"></a>
                                        <span class="name "><b>code</b>
                                            <a href="#code">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>code:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Warnungs-Code</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="message"></a>
                                        <span class="name "><b>message</b>
                                            <a href="#message">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>message:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Warnungsmeldung</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="path"></a>
                                        <span class="name "><b>path</b>
                                            <a href="#path">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>path:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Betroffener JSON-Pfad</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="recommendation"></a>
                                        <span class="name "><b>recommendation</b>
                                            <a href="#recommendation">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>recommendation:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                            <tr>
                                <td class="col-md-4">
                                    <div class="io-description"><p>Empfohlene Aktion</p>
</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import Ajv, { ValidateFunction } from &#x27;ajv&#x27;;
import addFormats from &#x27;ajv-formats&#x27;;
import {
  CURRENT_SCHEMA_VERSION,
  ImportConfig,
  SEED_DATA_JSON_SCHEMA,
  SeedData,
  SIMPLE_SEED_DATA_JSON_SCHEMA,
  SimpleSeedData,
  SUPPORTED_SCHEMA_VERSIONS,
} from &#x27;./schema&#x27;;

/**
 * Validierungs-Ergebnis mit detaillierten Informationen.
 */
export interface ValidationResult {
  /** Ist die Validierung erfolgreich? */
  valid: boolean;
  /** Validierte und geparste Daten (nur bei Erfolg) */
  data?: SeedData | SimpleSeedData;
  /** Validierungsfehler */
  errors: ValidationError[];
  /** Warnungen (nicht-kritische Probleme) */
  warnings: ValidationWarning[];
  /** Erkanntes Schema-Format */
  detectedFormat: &#x27;full&#x27; | &#x27;simple&#x27; | &#x27;unknown&#x27;;
  /** Validierungs-Metadaten */
  metadata: {
    /** Schema-Version der Daten */
    schemaVersion?: string;
    /** Anzahl Eins√§tze */
    einsaetzeCount: number;
    /** Anzahl ETB-Eintr√§ge */
    etbEntriesCount: number;
    /** Gesch√§tzte Speichergr√∂√üe in Bytes */
    estimatedSizeBytes: number;
  };
}

/**
 * Validierungsfehler mit Kontext-Informationen.
 */
export interface ValidationError {
  /** Fehler-Code f√ºr programmatische Behandlung */
  code: string;
  /** Benutzerfreundliche Fehlermeldung */
  message: string;
  /** JSON-Pfad zum fehlerhaften Element */
  instancePath?: string;
  /** Schema-Pfad der verletzten Regel */
  schemaPath?: string;
  /** Zus√§tzliche Kontext-Daten */
  data?: any;
  /** Schweregrad des Fehlers */
  severity: &#x27;error&#x27; | &#x27;warning&#x27;;
}

/**
 * Validierungswarnung f√ºr nicht-kritische Probleme.
 */
export interface ValidationWarning {
  /** Warnungs-Code */
  code: string;
  /** Warnungsmeldung */
  message: string;
  /** Empfohlene Aktion */
  recommendation?: string;
  /** Betroffener JSON-Pfad */
  path?: string;
}

/**
 * Schema-Validator Klasse.
 */
export class SchemaValidator {
  private ajv: Ajv;
  private fullValidator: ValidateFunction;
  private simpleValidator: ValidateFunction;

  constructor() {
    // AJV mit Formaten initialisieren
    this.ajv &#x3D; new Ajv({
      allErrors: true,
      verbose: true,
      strict: false,
    });
    addFormats(this.ajv);

    // Validator-Funktionen kompilieren
    this.fullValidator &#x3D; this.ajv.compile(SEED_DATA_JSON_SCHEMA);
    this.simpleValidator &#x3D; this.ajv.compile(SIMPLE_SEED_DATA_JSON_SCHEMA);
  }

  /**
   * Validiert JSON-Daten und erkennt automatisch das Format.
   */
  validate(jsonData: any, config: ImportConfig &#x3D; {}): ValidationResult {
    const result: ValidationResult &#x3D; {
      valid: false,
      errors: [],
      warnings: [],
      detectedFormat: &#x27;unknown&#x27;,
      metadata: {
        einsaetzeCount: 0,
        etbEntriesCount: 0,
        estimatedSizeBytes: 0,
      },
    };

    try {
      // Format-Erkennung
      const format &#x3D; this.detectFormat(jsonData);
      result.detectedFormat &#x3D; format;

      if (format &#x3D;&#x3D;&#x3D; &#x27;unknown&#x27;) {
        result.errors.push({
          code: &#x27;UNKNOWN_FORMAT&#x27;,
          message:
            &#x27;Unbekanntes JSON-Format. Muss entweder vollst√§ndiges oder vereinfachtes Seed-Format sein.&#x27;,
          severity: &#x27;error&#x27;,
        });
        return result;
      }

      // Schema-Validierung
      const isValid &#x3D;
        format &#x3D;&#x3D;&#x3D; &#x27;full&#x27; ? this.fullValidator(jsonData) : this.simpleValidator(jsonData);

      if (!isValid) {
        // AJV-Fehler zu strukturierten Fehlern konvertieren
        const validator &#x3D; format &#x3D;&#x3D;&#x3D; &#x27;full&#x27; ? this.fullValidator : this.simpleValidator;
        result.errors.push(...this.convertAjvErrors(validator.errors || []));
        return result;
      }

      // Zus√§tzliche semantische Validierung
      const semanticValidation &#x3D; this.validateSemantics(jsonData, format, config);
      result.errors.push(...semanticValidation.errors);
      result.warnings.push(...semanticValidation.warnings);

      if (result.errors.length &#x3D;&#x3D;&#x3D; 0) {
        result.valid &#x3D; true;
        result.data &#x3D; jsonData;
        result.metadata &#x3D; this.generateMetadata(jsonData, format);
      }
    } catch (error) {
      result.errors.push({
        code: &#x27;VALIDATION_EXCEPTION&#x27;,
        message: &#x60;Validierung fehlgeschlagen: ${error.message}&#x60;,
        severity: &#x27;error&#x27;,
      });
    }

    return result;
  }

  /**
   * Erkennt das Format der JSON-Daten.
   */
  private detectFormat(data: any): &#x27;full&#x27; | &#x27;simple&#x27; | &#x27;unknown&#x27; {
    if (!data || typeof data !&#x3D;&#x3D; &#x27;object&#x27;) {
      return &#x27;unknown&#x27;;
    }

    // Vollst√§ndiges Format hat version, metadata und einsaetze
    if (data.version &amp;&amp; data.metadata &amp;&amp; data.einsaetze) {
      return &#x27;full&#x27;;
    }

    // Vereinfachtes Format hat nur einsatz
    if (data.einsatz &amp;&amp; typeof data.einsatz &#x3D;&#x3D;&#x3D; &#x27;object&#x27;) {
      return &#x27;simple&#x27;;
    }

    return &#x27;unknown&#x27;;
  }

  /**
   * Konvertiert AJV-Fehler zu strukturierten Fehlern.
   */
  private convertAjvErrors(ajvErrors: any[]): ValidationError[] {
    return ajvErrors.map((error) &#x3D;&gt; ({
      code: &#x60;SCHEMA_${error.keyword?.toUpperCase() || &#x27;ERROR&#x27;}&#x60;,
      message: this.humanizeAjvError(error),
      instancePath: error.instancePath,
      schemaPath: error.schemaPath,
      data: error.data,
      severity: &#x27;error&#x27; as const,
    }));
  }

  /**
   * Macht AJV-Fehlermeldungen benutzerfreundlicher.
   */
  private humanizeAjvError(error: any): string {
    const path &#x3D; error.instancePath || &#x27;Root&#x27;;

    switch (error.keyword) {
      case &#x27;required&#x27;:
        return &#x60;Pflichtfeld fehlt in ${path}: ${error.params.missingProperty}&#x60;;
      case &#x27;type&#x27;:
        return &#x60;Falscher Datentyp in ${path}: Erwartet ${error.params.type}, gefunden ${typeof error.data}&#x60;;
      case &#x27;minLength&#x27;:
        return &#x60;Wert in ${path} ist zu kurz: Mindestens ${error.params.limit} Zeichen erforderlich&#x60;;
      case &#x27;maxLength&#x27;:
        return &#x60;Wert in ${path} ist zu lang: Maximal ${error.params.limit} Zeichen erlaubt&#x60;;
      case &#x27;enum&#x27;:
        return &#x60;Ung√ºltiger Wert in ${path}: Muss einer der folgenden Werte sein: ${error.params.allowedValues.join(&#x27;, &#x27;)}&#x60;;
      case &#x27;format&#x27;:
        return &#x60;Ung√ºltiges Format in ${path}: ${error.params.format} erwartet&#x60;;
      case &#x27;minimum&#x27;:
        return &#x60;Wert in ${path} ist zu klein: Mindestens ${error.params.limit} erforderlich&#x60;;
      default:
        return &#x60;Validierungsfehler in ${path}: ${error.message}&#x60;;
    }
  }

  /**
   * F√ºhrt zus√§tzliche semantische Validierung durch.
   */
  private validateSemantics(
    data: any,
    format: &#x27;full&#x27; | &#x27;simple&#x27;,
    config: ImportConfig,
  ): {
    errors: ValidationError[];
    warnings: ValidationWarning[];
  } {
    const errors: ValidationError[] &#x3D; [];
    const warnings: ValidationWarning[] &#x3D; [];

    if (format &#x3D;&#x3D;&#x3D; &#x27;full&#x27;) {
      // Schema-Version pr√ºfen
      if (!SUPPORTED_SCHEMA_VERSIONS.includes(data.version)) {
        if (config.validationLevel &#x3D;&#x3D;&#x3D; &#x27;strict&#x27;) {
          errors.push({
            code: &#x27;UNSUPPORTED_SCHEMA_VERSION&#x27;,
            message: &#x60;Nicht unterst√ºtzte Schema-Version: ${data.version}. Unterst√ºtzt: ${SUPPORTED_SCHEMA_VERSIONS.join(&#x27;, &#x27;)}&#x60;,
            severity: &#x27;error&#x27;,
          });
        } else {
          warnings.push({
            code: &#x27;SCHEMA_VERSION_WARNING&#x27;,
            message: &#x60;Schema-Version ${data.version} ist nicht offiziell unterst√ºtzt&#x60;,
            recommendation: &#x60;Verwende Version ${CURRENT_SCHEMA_VERSION}&#x60;,
          });
        }
      }

      // Eins√§tze-Namen Eindeutigkeit pr√ºfen
      const einsatzNames &#x3D; data.einsaetze.map((e: any) &#x3D;&gt; e.name);
      const duplicateNames &#x3D; einsatzNames.filter(
        (name: string, index: number) &#x3D;&gt; einsatzNames.indexOf(name) !&#x3D;&#x3D; index,
      );

      if (duplicateNames.length &gt; 0) {
        errors.push({
          code: &#x27;DUPLICATE_EINSATZ_NAMES&#x27;,
          message: &#x60;Doppelte Einsatz-Namen gefunden: ${duplicateNames.join(&#x27;, &#x27;)}&#x60;,
          severity: &#x27;error&#x27;,
        });
      }

      // ETB-Eintr√§ge Validierung
      data.einsaetze.forEach((einsatz: any, einsatzIndex: number) &#x3D;&gt; {
        if (einsatz.etbEntries &amp;&amp; einsatz.etbEntries.length &gt; 0) {
          this.validateEtbEntries(
            einsatz.etbEntries,
            &#x60;einsaetze[${einsatzIndex}]&#x60;,
            errors,
            warnings,
          );
        }
      });
    }

    // Allgemeine Validierung f√ºr beide Formate
    this.validateCommonSemantics(data, format, errors, warnings, config);

    return { errors, warnings };
  }

  /**
   * Validiert ETB-Eintr√§ge auf Konsistenz.
   */
  private validateEtbEntries(
    etbEntries: any[],
    basePath: string,
    errors: ValidationError[],
    warnings: ValidationWarning[],
  ): void {
    // Laufende Nummern pr√ºfen
    const laufendeNummern &#x3D; etbEntries
      .filter((entry) &#x3D;&gt; entry.laufendeNummer)
      .map((entry) &#x3D;&gt; entry.laufendeNummer)
      .sort((a, b) &#x3D;&gt; a - b);

    // Duplikate pr√ºfen
    const duplicates &#x3D; laufendeNummern.filter(
      (num, index) &#x3D;&gt; laufendeNummern.indexOf(num) !&#x3D;&#x3D; index,
    );

    if (duplicates.length &gt; 0) {
      errors.push({
        code: &#x27;DUPLICATE_LAUFENDE_NUMMER&#x27;,
        message: &#x60;Doppelte laufende Nummern in ${basePath}: ${duplicates.join(&#x27;, &#x27;)}&#x60;,
        severity: &#x27;error&#x27;,
      });
    }

    // Zeitstempel-Chronologie pr√ºfen
    let lastTimestamp: Date | null &#x3D; null;
    etbEntries.forEach((entry, index) &#x3D;&gt; {
      if (entry.timestampEreignis) {
        const timestamp &#x3D; new Date(entry.timestampEreignis);
        if (lastTimestamp &amp;&amp; timestamp &lt; lastTimestamp) {
          warnings.push({
            code: &#x27;TIMESTAMP_ORDER&#x27;,
            message: &#x60;Zeitstempel in ${basePath}.etbEntries[${index}] ist nicht chronologisch&#x60;,
            recommendation: &#x27;√úberpr√ºfe die Zeitstempel-Reihenfolge&#x27;,
            path: &#x60;${basePath}.etbEntries[${index}].timestampEreignis&#x60;,
          });
        }
        lastTimestamp &#x3D; timestamp;
      }
    });
  }

  /**
   * Allgemeine semantische Validierung f√ºr beide Formate.
   */
  private validateCommonSemantics(
    data: any,
    format: &#x27;full&#x27; | &#x27;simple&#x27;,
    errors: ValidationError[],
    warnings: ValidationWarning[],
    _config: ImportConfig,
  ): void {
    // Einsatz-Namen L√§ngen-Validierung
    const einsaetze &#x3D; format &#x3D;&#x3D;&#x3D; &#x27;full&#x27; ? data.einsaetze : [data.einsatz];

    einsaetze.forEach((einsatz: any, index: number) &#x3D;&gt; {
      if (einsatz.name &amp;&amp; einsatz.name.length &gt; 255) {
        errors.push({
          code: &#x27;EINSATZ_NAME_TOO_LONG&#x27;,
          message: &#x60;Einsatz-Name zu lang (${einsatz.name.length} Zeichen, max. 255)&#x60;,
          severity: &#x27;error&#x27;,
          instancePath: format &#x3D;&#x3D;&#x3D; &#x27;full&#x27; ? &#x60;einsaetze[${index}].name&#x60; : &#x27;einsatz.name&#x27;,
        });
      }
    });

    // Performance-Warnungen
    if (format &#x3D;&#x3D;&#x3D; &#x27;full&#x27;) {
      const totalEtbEntries &#x3D; data.einsaetze.reduce(
        (sum: number, einsatz: any) &#x3D;&gt; sum + (einsatz.etbEntries?.length || 0),
        0,
      );

      if (totalEtbEntries &gt; 1000) {
        warnings.push({
          code: &#x27;LARGE_DATASET&#x27;,
          message: &#x60;Gro√üer Datensatz mit ${totalEtbEntries} ETB-Eintr√§gen&#x60;,
          recommendation: &#x27;Import k√∂nnte l√§nger dauern. Erw√§ge --dry-run Option.&#x27;,
        });
      }
    }
  }

  /**
   * Generiert Metadaten f√ºr validierte Daten.
   */
  private generateMetadata(data: any, format: &#x27;full&#x27; | &#x27;simple&#x27;): ValidationResult[&#x27;metadata&#x27;] {
    const metadata: ValidationResult[&#x27;metadata&#x27;] &#x3D; {
      einsaetzeCount: 0,
      etbEntriesCount: 0,
      estimatedSizeBytes: 0,
    };

    if (format &#x3D;&#x3D;&#x3D; &#x27;full&#x27;) {
      metadata.schemaVersion &#x3D; data.version;
      metadata.einsaetzeCount &#x3D; data.einsaetze.length;
      metadata.etbEntriesCount &#x3D; data.einsaetze.reduce(
        (sum: number, einsatz: any) &#x3D;&gt; sum + (einsatz.etbEntries?.length || 0),
        0,
      );
    } else {
      metadata.einsaetzeCount &#x3D; 1;
      metadata.etbEntriesCount &#x3D; data.initialEtbEntries?.length || 0;
    }

    // Grobe Sch√§tzung der Speichergr√∂√üe
    metadata.estimatedSizeBytes &#x3D; JSON.stringify(data).length;

    return metadata;
  }
}

/**
 * Convenience-Funktion f√ºr schnelle Validierung.
 */
export function validateSeedData(jsonData: any, config: ImportConfig &#x3D; {}): ValidationResult {
  const validator &#x3D; new SchemaValidator();
  return validator.validate(jsonData, config);
}

/**
 * Validiert eine JSON-String.
 */
export function validateSeedDataString(
  jsonString: string,
  config: ImportConfig &#x3D; {},
): ValidationResult {
  try {
    const data &#x3D; JSON.parse(jsonString);
    return validateSeedData(data, config);
  } catch (parseError) {
    return {
      valid: false,
      errors: [
        {
          code: &#x27;JSON_PARSE_ERROR&#x27;,
          message: &#x60;JSON Parse-Fehler: ${parseError.message}&#x60;,
          severity: &#x27;error&#x27;,
        },
      ],
      warnings: [],
      detectedFormat: &#x27;unknown&#x27;,
      metadata: {
        einsaetzeCount: 0,
        etbEntriesCount: 0,
        estimatedSizeBytes: 0,
      },
    };
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'ValidationWarning.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
